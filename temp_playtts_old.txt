        private async Task PlayTts(string? text)
        {
            text ??= string.Empty;
            await ExceptionHandlingService.Tts.ExecuteSafelyAsync(async () =>
            {
                if (string.IsNullOrWhiteSpace(text)) return;
                var ttsConfig = _appSettings.GetActiveTtsConfiguration();
                if (ttsConfig == null)
                {
                    MessageBox.Show("未找到TTS配置，请先在设置中配置并激活TTS服务。", "提示", MessageBoxButton.OK, MessageBoxImage.Information);
                    return;
                }
