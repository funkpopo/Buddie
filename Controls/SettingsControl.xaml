<UserControl x:Class="Buddie.Controls.SettingsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:Buddie.Controls"
             xmlns:controls="clr-namespace:Buddie.Controls"
             xmlns:loc="clr-namespace:Buddie.Localization">
    
    
    <!-- 设置界面 - 位于右下角CardContainer附近 -->
    <Border x:Name="SettingsInterface"
            Width="460"
            Height="700"
            CornerRadius="10"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Margin="0,0,38,160"
            Effect="{StaticResource CardShadow}"
            Visibility="Collapsed">
        <Border.Style>
            <Style TargetType="Border">
                <Setter Property="Background" Value="White"/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                        <Setter Property="Background" Value="#1E1E1E"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Border.Style>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <!-- 设置界面标题栏 -->
            <Border Grid.Row="0"
                    CornerRadius="10,10,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
                    Cursor="Hand">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Background" Value="#F0F0F0"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                <Setter Property="Background" Value="#333333"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <Grid>
                    <TextBlock Text="{loc:Resx Settings_Title}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               Margin="15,0,0,0"
                               FontWeight="Bold">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="Black"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <Button Content="×"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Width="20"
                            Height="20"
                            Margin="0,0,10,0"
                            Background="Transparent"
                            BorderThickness="0"
                            FontSize="14"
                            FontWeight="Bold"
                            Command="{Binding CloseCommand}"
                            Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Foreground" Value="Black"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                        <Setter Property="Foreground" Value="White"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>
            <!-- 设置内容区域 -->
            <TabControl Grid.Row="1"
                        Margin="10"
                        Background="Transparent"
                        BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem" BasedOn="{StaticResource CustomTabItemStyle}"/>
                </TabControl.Resources>
                <!-- 基本设置页 -->
                <TabItem Header="{loc:Resx Settings_Tab_General}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewerStyle}">
                        <StackPanel Margin="15">
                            <TextBlock Text="{loc:Resx Settings_Sec_Appearance}"
                                       FontWeight="Bold"
                                       Margin="0,0,0,15"
                                       FontSize="14">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                <Setter Property="Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            
                            <Grid Margin="0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{loc:Resx Settings_TopMost}" FontWeight="Medium">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="Black"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock Text="{loc:Resx Settings_TopMost_Desc}" FontSize="11" Margin="0,2,0,0" x:Name="TopMostDescription">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="Gray"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                        <Setter Property="Foreground" Value="#AAAAAA"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                                <CheckBox x:Name="TopMostCheckBox"
                                          Grid.Column="1"
                                          IsChecked="{Binding IsTopmost, Mode=TwoWay}"
                                          Style="{StaticResource ToggleSwitchStyle}"/>
                            </Grid>
                            
                            <Separator Margin="0,8">
                                <Separator.Style>
                                    <Style TargetType="Separator">
                                        <Setter Property="Background" Value="#E0E0E0"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                <Setter Property="Background" Value="#404040"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Separator.Style>
                            </Separator>
                            
                            <Grid Margin="0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{loc:Resx Settings_ShowInTaskbar}" FontWeight="Medium">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="Black"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock Text="{loc:Resx Settings_ShowInTaskbar_Desc}" FontSize="11" Margin="0,2,0,0" x:Name="TaskbarDescription">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="Gray"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                        <Setter Property="Foreground" Value="#AAAAAA"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                                <CheckBox x:Name="ShowInTaskbarCheckBox"
                                          Grid.Column="1"
                                          IsChecked="{Binding ShowInTaskbar, Mode=TwoWay}"
                                          Style="{StaticResource ToggleSwitchStyle}"/>
                            </Grid>
                            
                            <Separator Margin="0,8">
                                <Separator.Style>
                                    <Style TargetType="Separator">
                                        <Setter Property="Background" Value="#E0E0E0"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                <Setter Property="Background" Value="#404040"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Separator.Style>
                            </Separator>
                            
                            <Grid Margin="0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{loc:Resx Settings_DarkMode}" FontWeight="Medium">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="Black"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock Text="{loc:Resx Settings_DarkMode_Desc}" FontSize="11" Margin="0,2,0,0" x:Name="DarkModeDescription">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="Gray"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                        <Setter Property="Foreground" Value="#AAAAAA"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                                <CheckBox x:Name="DarkThemeCheckBox"
                                          Grid.Column="1"
                                          IsChecked="{Binding IsDarkTheme, Mode=TwoWay}"
                                          Style="{StaticResource ToggleSwitchStyle}"/>
                            </Grid>
                            
                            <Separator Margin="0,15">
                                <Separator.Style>
                                    <Style TargetType="Separator">
                                        <Setter Property="Background" Value="#E0E0E0"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                <Setter Property="Background" Value="#404040"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Separator.Style>
                            </Separator>
                            <TextBlock Text="{loc:Resx Settings_Sec_Others}"
                                       FontWeight="Bold"
                                       Margin="0,0,0,10"
                                       FontSize="14">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                <Setter Property="Foreground" Value="White"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <Button Content="{loc:Resx Settings_ResetAll}"
                                    Background="#FF6B6B"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Padding="10,5"
                                    Margin="0,10,0,0"
                                    Command="{Binding ResetCommand}"
                                    Cursor="Hand"
                                    Style="{StaticResource RoundedButtonStyle}"/>

                            <!-- 语言设置 -->
                            <Separator Margin="0,15">
                                <Separator.Style>
                                    <Style TargetType="Separator">
                                        <Setter Property="Background" Value="#E0E0E0"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkTheme}" Value="True">
                                                <Setter Property="Background" Value="#404040"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Separator.Style>
                            </Separator>
                            <Grid Margin="0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{loc:Resx Settings_Language}" FontWeight="Medium"/>
                                    <TextBlock Text="{loc:Resx Settings_Language_Desc}" FontSize="11" Margin="0,2,0,0"/>
                                </StackPanel>
                                <ComboBox x:Name="LanguageComboBox" Width="160" Grid.Column="1" SelectionChanged="LanguageComboBox_SelectionChanged">
                                    <ComboBoxItem Content="{loc:Resx Lang_ChineseSimplified}" Tag="zh-CN"/>
                                    <ComboBoxItem Content="{loc:Resx Lang_English}" Tag="en-US"/>
                                </ComboBox>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <!-- 对话模型设置页 -->
                <TabItem Header="{loc:Resx Settings_Tab_Api}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewerStyle}">
                        <controls:ApiConfigControl x:Name="ApiConfigControl"/>
                    </ScrollViewer>
                </TabItem>
                <!-- TTS设置页 -->
                <TabItem Header="{loc:Resx Settings_Tab_TTS}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewerStyle}">
                        <controls:TtsConfigControl x:Name="TtsConfigControl"/>
                    </ScrollViewer>
                </TabItem>
                <!-- 实时交互设置页 -->
                <TabItem Header="{loc:Resx Settings_Tab_Realtime}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewerStyle}">
                        <controls:RealtimeConfigControl x:Name="RealtimeConfigControl"/>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
        </Grid>
    </Border>
</UserControl>
