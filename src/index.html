<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Card Stack Floating Window</title>
    <style>
      body {
        margin: 0;
        padding: 20px;
        overflow: hidden;
        background: transparent;
        user-select: none;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        width: calc(100vw - 40px);
        height: calc(100vh - 40px);
        box-sizing: border-box;
      }
      
      .card-container {
        display: flex;
        align-items: center;
        position: relative;
        padding: 0;
        width: 300px;
        justify-content: center;
      }
      
      .nav-btn {
        position: absolute;
        width: 30px;
        height: 30px;
        border: none;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(15px);
        color: rgba(255, 255, 255, 0.9);
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        border: 2px solid rgba(255, 255, 255, 0.25);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        z-index: 100;
        top: 50%;
        transform: translateY(-50%);
      }
      
      .nav-btn:hover {
        background: rgba(255, 255, 255, 0.25);
        color: rgba(255, 255, 255, 1);
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        border-color: rgba(255, 255, 255, 0.4);
      }
      
      .nav-btn:active {
        transform: translateY(0px) scale(0.98);
        background: rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      }
      
      .nav-btn-left {
        left: 10px;
      }
      
      .nav-btn-right {
        right: 10px;
      }
      
      .card-stack {
        position: relative;
        width: 260px;
        height: 180px;
        perspective: 1000px;
        cursor: move;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      
      /* 卡片基础静态样式 */
      .card {
        position: absolute;
        width: 200px;
        height: 150px;
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        cursor: grab;
        box-shadow: 0 6px 25px rgba(0, 0, 0, 0.25);
        transform-style: preserve-3d;
        border: 2px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
        /* 移除transition，由JavaScript控制动画 */
        transition: none;
        /* 启用硬件加速 */
        will-change: transform, opacity;
        backface-visibility: hidden;
      }
      
      /* 卡片在非动画状态下的transition */
      .card:not(.animating) {
        transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
      }
      
      .card h1 {
        color: white;
        font-size: 14px;
        text-align: center;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.6), 
                     0 0 2px rgba(0, 0, 0, 0.8),
                     1px 1px 0 rgba(0, 0, 0, 0.8),
                     -1px -1px 0 rgba(0, 0, 0, 0.8),
                     1px -1px 0 rgba(0, 0, 0, 0.8),
                     -1px 1px 0 rgba(0, 0, 0, 0.8);
        margin: 0;
        font-weight: 600;
        letter-spacing: 0.5px;
      }
      
      .card p {
        color: rgba(255, 255, 255, 0.95);
        font-size: 10px;
        text-align: center;
        margin: 5px 0 0 0;
        font-weight: 400;
        opacity: 0.9;
        text-shadow: 0 1px 4px rgba(0, 0, 0, 0.5),
                     0 0 1px rgba(0, 0, 0, 0.7),
                     1px 1px 0 rgba(0, 0, 0, 0.6),
                     -1px -1px 0 rgba(0, 0, 0, 0.6),
                     1px -1px 0 rgba(0, 0, 0, 0.6),
                     -1px 1px 0 rgba(0, 0, 0, 0.6);
      }
      
      /* 卡片背景颜色类 - 50种平滑渐变颜色，色调梯度变化平缓 */
      .card.color-0 { background: linear-gradient(135deg, #ff0000 0%, #ff4000 100%); }
      .card.color-1 { background: linear-gradient(135deg, #ff2000 0%, #ff6000 100%); }
      .card.color-2 { background: linear-gradient(135deg, #ff4000 0%, #ff8000 100%); }
      .card.color-3 { background: linear-gradient(135deg, #ff6000 0%, #ffa000 100%); }
      .card.color-4 { background: linear-gradient(135deg, #ff8000 0%, #ffc000 100%); }
      .card.color-5 { background: linear-gradient(135deg, #ffa000 0%, #ffe000 100%); }
      .card.color-6 { background: linear-gradient(135deg, #ffc000 0%, #ffff00 100%); }
      .card.color-7 { background: linear-gradient(135deg, #ffe000 0%, #e0ff00 100%); }
      .card.color-8 { background: linear-gradient(135deg, #ffff00 0%, #c0ff00 100%); }
      .card.color-9 { background: linear-gradient(135deg, #e0ff00 0%, #a0ff00 100%); }
      .card.color-10 { background: linear-gradient(135deg, #c0ff00 0%, #80ff00 100%); }
      .card.color-11 { background: linear-gradient(135deg, #a0ff00 0%, #60ff00 100%); }
      .card.color-12 { background: linear-gradient(135deg, #80ff00 0%, #40ff00 100%); }
      .card.color-13 { background: linear-gradient(135deg, #60ff00 0%, #20ff00 100%); }
      .card.color-14 { background: linear-gradient(135deg, #40ff00 0%, #00ff00 100%); }
      .card.color-15 { background: linear-gradient(135deg, #20ff00 0%, #00ff20 100%); }
      .card.color-16 { background: linear-gradient(135deg, #00ff00 0%, #00ff40 100%); }
      .card.color-17 { background: linear-gradient(135deg, #00ff20 0%, #00ff60 100%); }
      .card.color-18 { background: linear-gradient(135deg, #00ff40 0%, #00ff80 100%); }
      .card.color-19 { background: linear-gradient(135deg, #00ff60 0%, #00ffa0 100%); }
      .card.color-20 { background: linear-gradient(135deg, #00ff80 0%, #00ffc0 100%); }
      .card.color-21 { background: linear-gradient(135deg, #00ffa0 0%, #00ffe0 100%); }
      .card.color-22 { background: linear-gradient(135deg, #00ffc0 0%, #00ffff 100%); }
      .card.color-23 { background: linear-gradient(135deg, #00ffe0 0%, #00e0ff 100%); }
      .card.color-24 { background: linear-gradient(135deg, #00ffff 0%, #00c0ff 100%); }
      .card.color-25 { background: linear-gradient(135deg, #00e0ff 0%, #00a0ff 100%); }
      .card.color-26 { background: linear-gradient(135deg, #00c0ff 0%, #0080ff 100%); }
      .card.color-27 { background: linear-gradient(135deg, #00a0ff 0%, #0060ff 100%); }
      .card.color-28 { background: linear-gradient(135deg, #0080ff 0%, #0040ff 100%); }
      .card.color-29 { background: linear-gradient(135deg, #0060ff 0%, #0020ff 100%); }
      .card.color-30 { background: linear-gradient(135deg, #0040ff 0%, #0000ff 100%); }
      .card.color-31 { background: linear-gradient(135deg, #0020ff 0%, #2000ff 100%); }
      .card.color-32 { background: linear-gradient(135deg, #0000ff 0%, #4000ff 100%); }
      .card.color-33 { background: linear-gradient(135deg, #2000ff 0%, #6000ff 100%); }
      .card.color-34 { background: linear-gradient(135deg, #4000ff 0%, #8000ff 100%); }
      .card.color-35 { background: linear-gradient(135deg, #6000ff 0%, #a000ff 100%); }
      .card.color-36 { background: linear-gradient(135deg, #8000ff 0%, #c000ff 100%); }
      .card.color-37 { background: linear-gradient(135deg, #a000ff 0%, #e000ff 100%); }
      .card.color-38 { background: linear-gradient(135deg, #c000ff 0%, #ff00ff 100%); }
      .card.color-39 { background: linear-gradient(135deg, #e000ff 0%, #ff00e0 100%); }
      .card.color-40 { background: linear-gradient(135deg, #ff00ff 0%, #ff00c0 100%); }
      
      /* 叠放效果 - 更明显的堆叠视觉效果 */
      .card:nth-child(1) { 
        z-index: 5; 
        transform: translateY(0px) translateZ(0px) rotateY(0deg);
        transform-origin: center center;
      }
      .card:nth-child(2) { 
        z-index: 4; 
        transform: translateY(3px) translateZ(-8px) rotateY(-2deg) translateX(-2px);
        transform-origin: center center;
        opacity: 0.92;
      }
      .card:nth-child(3) { 
        z-index: 3; 
        transform: translateY(6px) translateZ(-16px) rotateY(-4deg) translateX(-4px);
        transform-origin: center center;
        opacity: 0.84;
      }
      .card:nth-child(4) { 
        z-index: 2; 
        transform: translateY(9px) translateZ(-24px) rotateY(-6deg) translateX(-6px);
        transform-origin: center center;
        opacity: 0.76;
      }
      .card:nth-child(5) { 
        z-index: 1; 
        transform: translateY(12px) translateZ(-32px) rotateY(-8deg) translateX(-8px);
        transform-origin: center center;
        opacity: 0.68;
      }
      
      /* 悬停效果 - 重新设计为更精确的层级控制 */
      .card-stack:not(.flipping):hover .card:nth-child(1) {
        transform: translateY(0px) translateZ(5px) rotateY(0deg) translateX(0px);
        opacity: 1;
      }
      .card-stack:not(.flipping):hover .card:nth-child(2) {
        transform: translateY(3px) translateZ(0px) rotateY(-2deg) translateX(-2px);
        opacity: 0.92;
      }
      .card-stack:not(.flipping):hover .card:nth-child(3) {
        transform: translateY(6px) translateZ(-8px) rotateY(-4deg) translateX(-4px);
        opacity: 0.84;
      }
      .card-stack:not(.flipping):hover .card:nth-child(4) {
        transform: translateY(9px) translateZ(-16px) rotateY(-6deg) translateX(-6px);
        opacity: 0.76;
      }
      .card-stack:not(.flipping):hover .card:nth-child(5) {
        transform: translateY(12px) translateZ(-24px) rotateY(-8deg) translateX(-8px);
        opacity: 0.68;
      }
      
      /* 翻页动画 - 重新设计为更流畅的动画 */
      .card-stack.flipping .card {
        transition: all 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
      }
      
      .card-stack.flipping .card.flip-out {
        animation: flip-out-new 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
      }
      
      .card-stack.flipping .card.flip-out-reverse {
        animation: flip-out-reverse 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
      }
      
      .card-stack.flipping .card.flip-in {
        animation: flip-in-reverse 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
      }
      
      .card-stack.flipping .card.move-forward {
        animation: move-forward 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
      }
      
      .card-stack.flipping .card.move-backward {
        animation: move-backward 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
      }
      
      /* 新的翻页动画关键帧 - 优化为更平滑的动画 */
      @keyframes flip-out-new {
        0% {
          transform: translateY(0px) translateZ(0px) rotateY(0deg) translateX(0px);
          opacity: 1;
        }
        25% {
          transform: translateY(-8px) translateZ(15px) rotateY(45deg) translateX(5px);
          opacity: 0.9;
        }
        50% {
          transform: translateY(5px) translateZ(-10px) rotateY(90deg) translateX(-8px);
          opacity: 0.7;
        }
        100% {
          transform: translateY(12px) translateZ(-32px) rotateY(-8deg) translateX(-8px);
          opacity: 0.68;
        }
      }
      
      @keyframes flip-out-reverse {
        0% {
          transform: translateY(0px) translateZ(0px) rotateY(0deg) translateX(0px);
          opacity: 1;
        }
        25% {
          transform: translateY(-8px) translateZ(15px) rotateY(-45deg) translateX(-5px);
          opacity: 0.9;
        }
        50% {
          transform: translateY(5px) translateZ(-10px) rotateY(-90deg) translateX(8px);
          opacity: 0.7;
        }
        100% {
          transform: translateY(12px) translateZ(-32px) rotateY(8deg) translateX(8px);
          opacity: 0.68;
        }
      }
      
      @keyframes flip-in-reverse {
        0% {
          transform: translateY(12px) translateZ(-32px) rotateY(-8deg) translateX(-8px);
          opacity: 0.68;
        }
        25% {
          transform: translateY(5px) translateZ(-10px) rotateY(-90deg) translateX(-8px);
          opacity: 0.7;
        }
        50% {
          transform: translateY(-8px) translateZ(15px) rotateY(-45deg) translateX(5px);
          opacity: 0.9;
        }
        100% {
          transform: translateY(0px) translateZ(0px) rotateY(0deg) translateX(0px);
          opacity: 1;
        }
      }
      
      @keyframes move-forward {
        0% {
          transform: var(--start-transform);
          opacity: var(--start-opacity);
        }
        100% {
          transform: var(--end-transform);
          opacity: var(--end-opacity);
        }
      }
      
      @keyframes move-backward {
        0% {
          transform: var(--start-transform);
          opacity: var(--start-opacity);
        }
        100% {
          transform: var(--end-transform);
          opacity: var(--end-opacity);
        }
      }
      
      /* 底部工具栏样式 */
      .bottom-toolbar {
        position: fixed;
        bottom: 20px;
        right: 20px;
        display: flex;
        gap: 10px;
        z-index: 1000;
      }
      
      .toolbar-btn {
        width: 40px;
        height: 40px;
        border: none;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(15px);
        color: rgba(255, 255, 255, 0.9);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        border: 2px solid rgba(255, 255, 255, 0.25);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }
      
      .toolbar-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        border-color: rgba(255, 255, 255, 0.4);
      }
      
      .toolbar-btn:active {
        transform: translateY(0px) scale(0.98);
        background: rgba(255, 255, 255, 0.25);
      }
      
      /* 面板样式 */
      .panel {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.8);
        width: 90%;
        max-width: 500px;
        height: 80%;
        max-height: 600px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 15px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.3);
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        display: flex;
        flex-direction: column;
      }
      
      .panel.show {
        opacity: 1;
        visibility: visible;
        transform: translate(-50%, -50%) scale(1);
      }
      
      .panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px 15px 0 0;
      }
      
      .panel-header h3 {
        margin: 0;
        font-size: 18px;
        color: rgba(0, 0, 0, 0.8);
        font-weight: 600;
      }
      
      .panel-close-btn {
        width: 30px;
        height: 30px;
        border: none;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.1);
        color: rgba(0, 0, 0, 0.6);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        font-weight: bold;
        transition: all 0.2s ease;
      }
      
      .panel-close-btn:hover {
        background: rgba(255, 0, 0, 0.2);
        color: rgba(255, 0, 0, 0.8);
      }
      
      .panel-content {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        color: rgba(0, 0, 0, 0.8);
      }
      
      /* 面板遮罩 */
      .panel-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1500;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }
      
      .panel-overlay.show {
        opacity: 1;
        visibility: visible;
      }
      
      /* 设置面板内容样式 */
      .settings-nav {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        padding-bottom: 10px;
      }
      
      .settings-nav .nav-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 8px;
        background: rgba(0, 0, 0, 0.1);
        color: rgba(0, 0, 0, 0.7);
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s ease;
      }
      
      .settings-nav .nav-btn.active,
      .settings-nav .nav-btn:hover {
        background: rgba(0, 0, 0, 0.2);
        color: rgba(0, 0, 0, 0.9);
      }
      
      .settings-page {
        display: none;
      }
      
      .settings-page.active {
        display: block;
      }
      
      .setting-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      }
      
      .setting-item label {
        color: rgba(0, 0, 0, 0.8);
        font-size: 14px;
        font-weight: 500;
      }
      
      .checkbox-label {
        display: flex;
        align-items: center;
        cursor: pointer;
      }
      
      .checkbox-label input {
        margin-right: 8px;
      }
      
      .opacity-control {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .opacity-control input[type="range"] {
        width: 100px;
      }
      
      .opacity-control span {
        min-width: 40px;
        text-align: right;
        font-size: 12px;
        color: rgba(0, 0, 0, 0.6);
      }
      
      /* 聊天面板样式 */
      .chat-messages {
        height: 300px;
        overflow-y: auto;
        padding: 10px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        margin-bottom: 15px;
      }
      
      .message-bubble {
        margin: 10px 0;
        padding: 10px 15px;
        border-radius: 15px;
        max-width: 80%;
        word-wrap: break-word;
      }
      
      .user-message {
        background: rgba(0, 123, 255, 0.1);
        margin-left: auto;
        text-align: right;
      }
      
      .system-message {
        background: rgba(0, 0, 0, 0.1);
        margin-right: auto;
      }
      
      .chat-input-container {
        display: flex;
        gap: 10px;
        align-items: flex-end;
      }
      
      .chat-input {
        flex: 1;
        border: 1px solid rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 8px 12px;
        resize: none;
        font-size: 14px;
        max-height: 100px;
      }
      
      .chat-send-btn {
        width: 36px;
        height: 36px;
        border: none;
        border-radius: 50%;
        background: rgba(0, 123, 255, 0.8);
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }
      
      .chat-send-btn:hover {
        background: rgba(0, 123, 255, 1);
        transform: scale(1.05);
      }
    </style>
  </head>
  <body>
    <div class="card-container" id="cardContainer">
      <button class="nav-btn nav-btn-left" id="prevBtn" title="上一张卡片">‹</button>
      <div class="card-stack" id="cardStack">
        <div class="card color-0" data-card="1">
          <h1>🎵 唱片 1</h1>
          <p>Card One</p>
        </div>
        <div class="card color-1" data-card="2">
          <h1>🎶 唱片 2</h1>
          <p>Card Two</p>
        </div>
        <div class="card color-2" data-card="3">
          <h1>🎼 唱片 3</h1>
          <p>Card Three</p>
        </div>
        <div class="card color-3" data-card="4">
          <h1>🎤 唱片 4</h1>
          <p>Card Four</p>
        </div>
        <div class="card color-4" data-card="5">
          <h1>🎧 唱片 5</h1>
          <p>Card Five</p>
        </div>
      </div>
      <button class="nav-btn nav-btn-right" id="nextBtn" title="下一张卡片">›</button>
    </div>
    
    <!-- 底部工具栏 -->
    <div class="bottom-toolbar" id="bottomToolbar">
      <button class="toolbar-btn" id="settingsBtn" title="设置">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="m12 1 1.27 1.27a2 2 0 0 0 2.86 0l.42-.42a2 2 0 0 1 2.83 0l2.83 2.83a2 2 0 0 1 0 2.83l-.42.42a2 2 0 0 0 0 2.86L23 12l-1.27 1.27a2 2 0 0 0 0 2.86l.42.42a2 2 0 0 1 0 2.83l-2.83 2.83a2 2 0 0 1-2.83 0l-.42-.42a2 2 0 0 0-2.86 0L12 23l-1.27-1.27a2 2 0 0 0-2.86 0l-.42.42a2 2 0 0 1-2.83 0L1.79 19.32a2 2 0 0 1 0-2.83l.42-.42a2 2 0 0 0 0-2.86L1 12l1.27-1.27a2 2 0 0 0 0-2.86l-.42-.42a2 2 0 0 1 0-2.83L4.68 1.79a2 2 0 0 1 2.83 0l.42.42a2 2 0 0 0 2.86 0L12 1z"></path>
        </svg>
      </button>
      <button class="toolbar-btn" id="chatBtn" title="对话">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"></path>
        </svg>
      </button>
    </div>
    
    <!-- 设置面板 -->
    <div class="panel settings-panel" id="settingsPanel">
      <div class="panel-header">
        <h3>⚙️ 设置</h3>
        <button class="panel-close-btn" onclick="closePanel('settings')">×</button>
      </div>
      <div class="panel-content" id="settingsContent">
        <!-- 设置内容将由 JavaScript 动态加载 -->
      </div>
    </div>
    
    <!-- 聊天面板 -->
    <div class="panel chat-panel" id="chatPanel">
      <div class="panel-header">
        <h3>💬 AI对话</h3>
        <button class="panel-close-btn" onclick="closePanel('chat')">×</button>
      </div>
      <div class="panel-content" id="chatContent">
        <!-- 聊天内容将由 JavaScript 动态加载 -->
      </div>
    </div>
    
    <!-- 面板遮罩 -->
    <div class="panel-overlay" id="panelOverlay"></div>
  </body>
</html>
